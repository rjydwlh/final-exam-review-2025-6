#### 关系代数





​	并，差，交，笛卡尔积四种运算。

​	设两个集合为 $S_1$ ， $S_2$ 。

1. 并 $\cup$:

   二者元组之和并去除重复行。

2. 差 $-$：

   $S_1$ 减去 $S_1$与 $S_2$ 的重复行。

3. 交 $\cap$：

   $S_1$ 与 $S_2$ 的重复行。

4. 笛卡尔积： 

   集合 $S_1$ 与 $S_2$ 之间所有有序对元素的集合。

   产生的关系中元组的个数为两个关系中元组个数只积。

5. 投影 $\pi$：

   关系 R 上的投影是从 R 上选出若干属性组成新的关系。

   即若干列的一个局部视图，行数保持不变。

   **表达式**：$π_{属性1,属性2,...}(关系名)$ ，如 $π_{Sno,Sname}(Student)$ 表示选取学号和姓名列。

6. 选择 $\sigma$：

   又称为限制，在关系 R 中选择满足给定条件的一些元组，列保持不变，对行进行选取。

   **表达式**： $σ_{条件}(关系名)$ ，如$σ_{Age>20}(Student)$表示筛选年龄大于 20 的学生。

7. 自然连接 $\Join$：

​	基于两关系的同名属性进行等值连接，并自动去除重复列。

​	表达式：$Student ⋈ Enrollment$

8. 等值连接 $\Join$ ：

​	表达式 ： $Student ⋈_{Student.SID = Enrollment.SID}$

| **操作**      | **同名属性处理**                           | **结果属性**         |
| ------------- | ------------------------------------------ | -------------------- |
| 自然连接（⋈） | 仅保留一份同名属性，自动基于其等值匹配     | 去重后的所有属性     |
| 等值连接（=） | 保留所有属性（可能重命名），需显式指定条件 | 两关系所有属性的并集 |

假设有以下关系：



```plaintext
R(A, B) = {(1, 2), (3, 4)}  
S(B, C) = {(2, 5), (4, 6), (7, 8)}
```

自然连接 `R ⋈ S`：

- 匹配条件：`R.B = S.B`
- 结果：`{(1, 2, 5), (3, 4, 6)}`
- 解释：仅保留 `B` 相等的元组，且 `B` 只出现一次。

等值连接 `R ⋈_{R.B=S.B} S`：

- 结果：`{(1, R.B=2, S.B=2, 5), (3, R.B=4, S.B=4, 6)}`

- 解释：`R.B` 和 `S.B` 同时保留（实际中可能被重命名）。

  

![在这里插入图片描述](https://i-blog.csdnimg.cn/blog_migrate/5edae37d76c2ade437d7e1696963dcb0.png#pic_center)

---







#### 数据库 mysql



```mysql
create table student (
    id int primary key,      -- 主键
	name varchar(50) unique, -- 唯一值
    sex char(2) not null ,   -- 不为空
    foreign key 
);

CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    order_date DATE,
    -- 外键约束：customer_id 引用 customers 表的 customer_id
    FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);


ALTER TABLE orders
ADD CONSTRAINT fk_orders_customers
FOREIGN KEY (customer_id) REFERENCES customers(customer_id);


```



#### 外键约束选项

**1. ON DELETE 和 ON UPDATE 动作**

- **CASCADE**：父表删除 / 更新时，子表关联记录自动删除 / 更新。



```mysql
FOREIGN KEY (customer_id) REFERENCES customers(customer_id)

ON DELETE CASCADE ON UPDATE CASCADE;


```



- **SET NULL**：父表删除 / 更新时，子表外键设为 NULL（需外键允许 NULL）。



```mysql


FOREIGN KEY (customer_id) REFERENCES customers(customer_id)

ON DELETE SET NULL ON UPDATE SET NULL;

```



- **RESTRICT/NO ACTION**：阻止父表删除 / 更新（默认行为）。

- **SET DEFAULT**：父表删除 / 更新时，子表外键设为默认值（需定义默认值）。













